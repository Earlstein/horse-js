
/*! horse-js 23-10-2014 */
function Epilepsy(a){if(!a||!a.object||!$(a.object).length)throw new Error("required an object.");this.Epilepsies=[],this.opts=$.extend(this.defaultOptions,a)}function Runaway(a){for(var b in this.options)this[b]="undefined"!=typeof a&&a.hasOwnProperty(b)?a[b]:this.options[b]}function Storm(a){if(!a||!a.object||!$(a.object).length)throw new Error("required an object.");this.storms=[],this.opts=$.extend(this.defaultOptions,a)}Epilepsy.prototype.defaultOptions={spawners:8,minDelay:1e3,maxDelay:2e3,animation:null,minDuration:50,maxDuration:50},Epilepsy.prototype.options=function(a,b){if("undefined"==typeof a)return this.opts;var c=this.opts;if("undefined"==typeof b&&"object"==typeof a)$.extend(c,a);else{if("undefined"==typeof b)throw TypeError("unexpected configuration");var d={};d[a]=b,$.extend(c,d)}if(!this.validateOptions(c))throw Error("invalid parameter");return this.opts=c,this},Epilepsy.prototype.validateOptions=function(a){return a&&"number"===a.spawners&&a.spawners>0&&"number"===a.minDelay&&a.minDelay>=0&&"number"===a.maxDelay&&a.maxDelay>=0&&a.minDelay<=a.maxDelay&&"number"===a.minDuration&&a.minDuration>=0&&"number"===a.maxDuration&&a.maxDuration>=0&&a.minDuration<=a.maxDuration&&a.object instanceof jQuery&&1===a.object.length&&("function"==typeof a.animation||null===a.animation)},Epilepsy.prototype.start=function(){if(this.Epilepsies.length||this.opts.spawners<0)return this;for(var a=0;a<this.opts.spawners;a++)this.Epilepsies.push(this.generateSpawner());return this},Epilepsy.prototype.generateSpawner=function(a){"undefined"==typeof a&&(a=this.Epilepsies.length);var b=this.opts,c=$(b.object).first().clone().appendTo($("body")).css({position:"fixed",top:this.rand(0,window.innerHeight),left:this.rand(0,window.innerWidth)}),d=b.animation?$.proxy(b.animation,c):null;if(d)var e=this.rand(b.minDuration,b.maxDuration),f=window.setInterval(d,e);var g=this;return window.setTimeout(function(){window.clearInterval(f),c.remove(),g.Epilepsies[a]=g.generateSpawner(a)},this.rand(b.minDelay,b.maxDelay))},Epilepsy.prototype.stop=function(){var a=this.Epilepsies;this.Epilepsies=[];for(var b=0;b<a.length;b++)window.clearTimeout(a[b]);return this},Epilepsy.prototype.rand=function(a,b){if("undefined"==typeof a&&(a=0),"undefined"==typeof b&&(b=1),a>b)throw new RangeError("requested invalid range");return Math.floor(Math.random()*(b-a+1))+a},$.fn.runaway=function(a){$.each(this,function(){"undefined"==typeof this.runaway&&(this.runaway=new Runaway(a)),this.runaway.start(this)})},$.fn.staystill=function(){$.each(this,function(){"undefined"!=typeof this.runaway&&this.runaway.stop()})},Runaway.prototype.options={proximity:30,velocity:20},Runaway.prototype.velocity=0,Runaway.prototype.thing=null,Runaway.prototype.window=null,Runaway.prototype.uniqueId="",Runaway.prototype.start=function(a){this.thing=$(a),this.window=$(window),this.thing.css({position:"fixed","z-index":2147483647}),this.uniqueId=Math.random().toString(36).substr(2),this.window.on("mousemove.runaway"+this.uniqueId,$.proxy(this.run,this))},Runaway.prototype.run=function(a){var b=this.thing.offset(),c=this.thing.width()/2,d=this.thing.height()/2,e=[b.left+c-this.window.scrollLeft(),b.top+d-this.window.scrollTop()],f=[a.pageX-e[0],a.pageY-e[1]];if(!(Math.abs(f[0]-e[0])>this.proximity+c||Math.abs(f[1]-e[1])>this.proximity+d)){var g=[Math.cos(f[0]),Math.sin(f[1])],h=[c*g[0],d*g[1]],i=this.distance(f,h);if(!(i>this.proximity)){var j=[this.velocity*g[0],this.velocity*g[1]],k=[b.left-j[0],b.top-j[1]];(k[0]<0||k[0]>this.window.width()||k[1]<0||k[1]>this.window.height())&&(k[0]=Math.floor(Math.random()*this.window.width()),k[1]=Math.floor(Math.random()*this.window.height())),this.thing.offset({left:k[0],top:k[1]})}}},Runaway.prototype.distance=function(a,b){return Math.floor(Math.sqrt(Math.pow(b[1]-a[1],2)+Math.pow(b[0]-a[0],2)))},Runaway.prototype.stop=function(){this.thing.unbind("mouseover.runaway"+this.uniqueId)},Storm.prototype.defaultOptions={spawners:20,minDelay:600,maxDelay:800,minDuration:200,maxDuration:600},Storm.prototype.options=function(a,b){if("undefined"==typeof a)return this.opts;var c=this.opts;if("undefined"==typeof b&&"object"==typeof a)$.extend(c,a);else{if("undefined"==typeof b)throw TypeError("unexpected configuration");var d={};d[a]=b,$.extend(c,d)}if(!this.validateOptions(c))throw Error("invalid parameter");return this.opts=c,this},Storm.prototype.validateOptions=function(a){return a&&"number"===a.spawners&&a.spawners>0&&"number"===a.minDelay&&a.minDelay>=0&&"number"===a.maxDelay&&a.maxDelay>=0&&a.minDelay<=a.maxDelay&&"number"===a.minDuration&&a.minDuration>=0&&"number"===a.maxDuration&&a.maxDuration>=0&&a.minDuration<=a.maxDuration&&a.object instanceof jQuery&&1===a.object.length},Storm.prototype.start=function(){if(this.storms.length||this.opts.spawners<0)return this;for(var a=0;a<this.opts.spawners;a++)this.storms.push(this.generateSpawner());return this},Storm.prototype.generateSpawner=function(a){"undefined"==typeof a&&(a=this.storms.length);var b=this.opts,c=$(b.object).first().clone().appendTo($("body"));c.css({position:"fixed",left:-1*c.width(),top:this.rand(0,window.innerHeight)}).animate({left:window.innerWidth},this.rand(b.minDuration,b.maxDuration),"linear",function(){c.remove()});var d=this;return window.setTimeout(function(){d.storms[a]=d.generateSpawner(a)},this.rand(b.minDelay,b.maxDelay))},Storm.prototype.stop=function(){var a=this.storms;this.storms=[];for(var b=0;b<a.length;b++)window.clearTimeout(a[b]);return this},Storm.prototype.rand=function(a,b){if("undefined"==typeof a&&(a=0),"undefined"==typeof b&&(b=1),a>b)throw new RangeError("requested invalid range");return Math.floor(Math.random()*(b-a+1))+a};